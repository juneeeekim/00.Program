<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google OAuth í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: black; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-info { background: #17a2b8; color: white; }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: monospace;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.info { background: #d1ecf1; color: #0c5460; }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ Google OAuth 2.0 í…ŒìŠ¤íŠ¸ ë„êµ¬</h1>
        <p>ì´ í˜ì´ì§€ëŠ” Google OAuth ì„¤ì •ì„ í…ŒìŠ¤íŠ¸í•˜ê³  ë””ë²„ê¹…í•˜ê¸° ìœ„í•œ ë„êµ¬ì…ë‹ˆë‹¤.</p>
        
        <!-- ì„¤ì • ê²€ì¦ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ“‹ ì„¤ì • ê²€ì¦ í…ŒìŠ¤íŠ¸</h3>
            <div id="config-status"></div>
            <button class="btn btn-info" onclick="checkConfig()">ì „ì²´ ì„¤ì • í™•ì¸</button>
            <button class="btn btn-primary" onclick="testClientIdFormat()">Client ID í˜•ì‹ ê²€ì¦</button>
            <button class="btn btn-primary" onclick="testPlaceholderDetection()">í”Œë ˆì´ìŠ¤í™€ë” ê°ì§€</button>
            <button class="btn btn-primary" onclick="testEnvironmentValidation()">í™˜ê²½ ê²€ì¦ (HTTPS)</button>
            <button class="btn btn-warning" onclick="showSetupGuide()">ì„¤ì • ê°€ì´ë“œ</button>
        </div>
        
        <!-- OAuth í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ” OAuth í…ŒìŠ¤íŠ¸</h3>
            <div id="auth-status"></div>
            <button class="btn btn-primary" onclick="testGoogleLogin()">Google ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</button>
            <button class="btn btn-danger" onclick="testGoogleLogout()">Google ë¡œê·¸ì•„ì›ƒ í…ŒìŠ¤íŠ¸</button>
            <button class="btn btn-info" onclick="checkAuthStatus()">ì¸ì¦ ìƒíƒœ í™•ì¸</button>
        </div>
        
        <!-- í† í° ê´€ë¦¬ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ« í† í° ê´€ë¦¬ í…ŒìŠ¤íŠ¸</h3>
            <div id="token-status"></div>
            <button class="btn btn-success" onclick="testTokenRefresh()">í† í° ê°±ì‹  í…ŒìŠ¤íŠ¸</button>
            <button class="btn btn-info" onclick="validateToken()">í† í° ê²€ì¦</button>
            <button class="btn btn-warning" onclick="testTokenExpiry()">í† í° ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜</button>
            <button class="btn btn-primary" onclick="testAutoRefreshScheduling()">ìë™ ê°±ì‹  ìŠ¤ì¼€ì¤„ë§ í…ŒìŠ¤íŠ¸</button>
        </div>
        
        <!-- ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜ -->
        <div class="test-section">
            <h3>ğŸ“¦ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜</h3>
            <div id="migration-status"></div>
            <button class="btn btn-primary" onclick="simulateFullMigration()">ì „ì²´ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜</button>
            <button class="btn btn-success" onclick="testBackupCreation()">ë°±ì—… ìƒì„± í…ŒìŠ¤íŠ¸</button>
            <button class="btn btn-warning" onclick="testDataTransfer()">ë°ì´í„° ì´ì „ í…ŒìŠ¤íŠ¸</button>
            <button class="btn btn-info" onclick="testDataVerification()">ë°ì´í„° ê²€ì¦ í…ŒìŠ¤íŠ¸</button>
            <button class="btn btn-danger" onclick="testRollback()">ë¡¤ë°± í…ŒìŠ¤íŠ¸</button>
            <button class="btn btn-info" onclick="checkMigrationStatus()">ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒíƒœ</button>
            <button class="btn btn-warning" onclick="createTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±</button>
            <button class="btn btn-danger" onclick="clearTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ</button>
        </div>
        
        <!-- ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>âš ï¸ ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸</h3>
            <div id="error-status"></div>
            <button class="btn btn-warning" onclick="testConfigError()">ì„¤ì • ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤</button>
            <button class="btn btn-warning" onclick="testNetworkError()">ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤</button>
            <button class="btn btn-info" onclick="testUserCancellation()">ì‚¬ìš©ì ì·¨ì†Œ ì‹œë‚˜ë¦¬ì˜¤</button>
            <button class="btn btn-danger" onclick="testTokenError()">í† í° ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤</button>
            <button class="btn btn-danger" onclick="testMigrationFailure()">ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤</button>
            <button class="btn btn-primary" onclick="testErrorRecovery()">ì˜¤ë¥˜ ë³µêµ¬ í…ŒìŠ¤íŠ¸</button>
        </div>
        
        <!-- UX ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (Task 5) -->
        <div class="test-section">
            <h3>ğŸ¨ UX ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h3>
            <div id="ux-status"></div>
            <button class="btn btn-primary" onclick="testLoadingAnimation()">ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ í…ŒìŠ¤íŠ¸</button>
            <button class="btn btn-success" onclick="testToastSuccess()">í† ìŠ¤íŠ¸ (ì„±ê³µ)</button>
            <button class="btn btn-warning" onclick="testToastWarning()">í† ìŠ¤íŠ¸ (ê²½ê³ )</button>
            <button class="btn btn-danger" onclick="testToastError()">í† ìŠ¤íŠ¸ (ì˜¤ë¥˜)</button>
            <button class="btn btn-info" onclick="testToastInfo()">í† ìŠ¤íŠ¸ (ì •ë³´)</button>
            <button class="btn btn-primary" onclick="testMigrationProgress()">ë§ˆì´ê·¸ë ˆì´ì…˜ ì§„í–‰ í‘œì‹œ</button>
        </div>
        
        <!-- ë¡œê·¸ -->
        <div class="test-section">
            <h3>ğŸ“ ì‹¤ì‹œê°„ ë¡œê·¸</h3>
            <div id="log-container" class="log"></div>
            <button class="btn btn-warning" onclick="clearLog()">ë¡œê·¸ ì§€ìš°ê¸°</button>
        </div>
    </div>

    <!-- ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
    <script src="config/auth-config.js"></script>
    <script src="js/google-auth-manager.js"></script>
    <script src="js/data-migration-manager.js"></script>
    
    <script>
        // í…ŒìŠ¤íŠ¸ ë„êµ¬ ë³€ìˆ˜
        let authManager;
        let migrationManager;
        let config;
        
        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', async () => {
            config = window.AUTH_CONFIG;
            authManager = new GoogleAuthManager(config);
            migrationManager = new DataMigrationManager(config);
            
            // ì½œë°± ì„¤ì •
            setupCallbacks();
            
            // ì´ˆê¸° ìƒíƒœ í™•ì¸
            await checkConfig();
            
            log('í…ŒìŠ¤íŠ¸ ë„êµ¬ ì´ˆê¸°í™” ì™„ë£Œ');
        });
        
        // ì½œë°± ì„¤ì •
        function setupCallbacks() {
            authManager.onSignInSuccess = (userData) => {
                log(`âœ… ë¡œê·¸ì¸ ì„±ê³µ: ${userData.name} (${userData.email})`);
                updateAuthStatus('success', `ë¡œê·¸ì¸ë¨: ${userData.name}`);
            };
            
            authManager.onSignInError = (error) => {
                log(`âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨: ${error.error || error.message}`);
                updateAuthStatus('error', `ë¡œê·¸ì¸ ì‹¤íŒ¨: ${error.error || error.message}`);
            };
            
            authManager.onSignOutSuccess = () => {
                log('âœ… ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
                updateAuthStatus('info', 'ë¡œê·¸ì•„ì›ƒë¨');
            };
            
            authManager.onTokenRefresh = (tokenData) => {
                log(`ğŸ”„ í† í° ê°±ì‹ : ${new Date(tokenData.refreshTime).toLocaleString()}`);
            };
        }
        
        // ì„¤ì • í™•ì¸
        async function checkConfig() {
            const isValid = config.validateGoogleConfig();
            const envConfig = config.getEnvironmentConfig();
            
            const status = `
                <div class="status ${isValid ? 'success' : 'error'}">
                    <strong>ì„¤ì • ìƒíƒœ:</strong> ${isValid ? 'âœ… ì™„ë£Œ' : 'âŒ ë¯¸ì™„ë£Œ'}<br>
                    <strong>í™˜ê²½:</strong> ${envConfig.isDevelopment ? 'ê°œë°œ' : 'í”„ë¡œë•ì…˜'}<br>
                    <strong>í´ë¼ì´ì–¸íŠ¸ ID:</strong> ${envConfig.clientId}<br>
                    <strong>ìŠ¤ì½”í”„:</strong> ${envConfig.scopes.join(', ')}<br>
                    <strong>í—ˆìš© ë„ë©”ì¸:</strong> ${envConfig.allowedOrigins.join(', ')}
                </div>
            `;
            
            document.getElementById('config-status').innerHTML = status;
            
            if (isValid) {
                try {
                    await authManager.initialize();
                    log('Google OAuth ì´ˆê¸°í™” ì„±ê³µ');
                } catch (error) {
                    log(`Google OAuth ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`);
                }
            }
        }
        
        // ì„¤ì • ê°€ì´ë“œ í‘œì‹œ
        function showSetupGuide() {
            alert(config.getSetupInstructions());
        }
        
        // Google ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
        async function testGoogleLogin() {
            try {
                log('Google ë¡œê·¸ì¸ ì‹œë„...');
                await authManager.signIn();
            } catch (error) {
                log(`ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`);
            }
        }
        
        // Google ë¡œê·¸ì•„ì›ƒ í…ŒìŠ¤íŠ¸
        async function testGoogleLogout() {
            try {
                log('Google ë¡œê·¸ì•„ì›ƒ ì‹œë„...');
                await authManager.signOut();
            } catch (error) {
                log(`ë¡œê·¸ì•„ì›ƒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`);
            }
        }
        
        // ì¸ì¦ ìƒíƒœ í™•ì¸
        function checkAuthStatus() {
            const isSignedIn = authManager.isSignedIn();
            const currentUser = authManager.getCurrentUser();
            
            let status = `<div class="status ${isSignedIn ? 'success' : 'info'}">`;
            status += `<strong>ë¡œê·¸ì¸ ìƒíƒœ:</strong> ${isSignedIn ? 'âœ… ë¡œê·¸ì¸ë¨' : 'âŒ ë¡œê·¸ì•„ì›ƒë¨'}<br>`;
            
            if (currentUser) {
                status += `<strong>ì‚¬ìš©ì:</strong> ${currentUser.name} (${currentUser.email})<br>`;
                status += `<strong>í† í° ìœ íš¨:</strong> ${currentUser.isValid ? 'âœ…' : 'âŒ'}<br>`;
                status += `<strong>ë§Œë£Œ ì‹œê°„:</strong> ${new Date(currentUser.expiresAt).toLocaleString()}`;
            }
            
            status += '</div>';
            document.getElementById('auth-status').innerHTML = status;
            
            log(`ì¸ì¦ ìƒíƒœ í™•ì¸: ${isSignedIn ? 'ë¡œê·¸ì¸ë¨' : 'ë¡œê·¸ì•„ì›ƒë¨'}`);
        }
        
        // ===== ì„¤ì • ê²€ì¦ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ =====
        
        // Client ID í˜•ì‹ ê²€ì¦ í…ŒìŠ¤íŠ¸
        function testClientIdFormat() {
            log('Client ID í˜•ì‹ ê²€ì¦ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            const clientId = config.GOOGLE_CLIENT_ID;
            const isValid = clientId.endsWith('.googleusercontent.com');
            
            const message = isValid 
                ? `âœ… Client ID í˜•ì‹ì´ ì˜¬ë°”ë¦…ë‹ˆë‹¤: ${clientId}`
                : `âŒ Client ID í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤: ${clientId}`;
            
            updateConfigStatus(isValid ? 'success' : 'error', message);
            log(message);
        }
        
        // í”Œë ˆì´ìŠ¤í™€ë” ê°ì§€ í…ŒìŠ¤íŠ¸
        function testPlaceholderDetection() {
            log('í”Œë ˆì´ìŠ¤í™€ë” ê°ì§€ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            const clientId = config.GOOGLE_CLIENT_ID;
            const hasPlaceholder = clientId.includes('YOUR_');
            
            const message = hasPlaceholder
                ? `âš ï¸ í”Œë ˆì´ìŠ¤í™€ë” ê°ì§€ë¨: ${clientId}`
                : `âœ… í”Œë ˆì´ìŠ¤í™€ë” ì—†ìŒ: ì„¤ì • ì™„ë£Œ`;
            
            updateConfigStatus(hasPlaceholder ? 'error' : 'success', message);
            log(message);
            
            if (hasPlaceholder) {
                log('ì„¤ì • ì•ˆë‚´ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
            }
        }
        
        // í™˜ê²½ ê²€ì¦ í…ŒìŠ¤íŠ¸
        function testEnvironmentValidation() {
            log('í™˜ê²½ ê²€ì¦ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            const isDev = config.isDevelopment;
            const protocol = window.location.protocol;
            const hostname = window.location.hostname;
            
            let message = `í™˜ê²½: ${isDev ? 'ê°œë°œ' : 'í”„ë¡œë•ì…˜'}<br>`;
            message += `í”„ë¡œí† ì½œ: ${protocol}<br>`;
            message += `í˜¸ìŠ¤íŠ¸: ${hostname}<br>`;
            
            if (!isDev && protocol !== 'https:') {
                message += `âŒ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” HTTPSê°€ í•„ìš”í•©ë‹ˆë‹¤!`;
                updateConfigStatus('error', message);
                log('âŒ HTTPS ê²€ì¦ ì‹¤íŒ¨: í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ HTTP ì‚¬ìš© ì¤‘');
            } else if (isDev && (hostname === 'localhost' || hostname === '127.0.0.1')) {
                message += `âœ… ê°œë°œ í™˜ê²½: HTTP í—ˆìš©ë¨`;
                updateConfigStatus('success', message);
                log('âœ… í™˜ê²½ ê²€ì¦ ì„±ê³µ: ê°œë°œ í™˜ê²½');
            } else {
                message += `âœ… í™˜ê²½ ì„¤ì •ì´ ì˜¬ë°”ë¦…ë‹ˆë‹¤`;
                updateConfigStatus('success', message);
                log('âœ… í™˜ê²½ ê²€ì¦ ì„±ê³µ');
            }
        }
        
        function updateConfigStatus(type, message) {
            document.getElementById('config-status').innerHTML = 
                `<div class="status ${type}">${message}</div>`;
        }
        
        // ===== í† í° ê´€ë¦¬ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ =====
        
        // í† í° ê°±ì‹  í…ŒìŠ¤íŠ¸
        async function testTokenRefresh() {
            try {
                log('í† í° ê°±ì‹  í…ŒìŠ¤íŠ¸ ì‹œì‘...');
                showLoadingIndicator('í† í° ê°±ì‹  ì¤‘...');
                
                const tokenData = await authManager.refreshToken();
                hideLoadingIndicator();
                
                if (tokenData) {
                    const message = `âœ… í† í° ê°±ì‹  ì„±ê³µ<br>ê°±ì‹  ì‹œê°„: ${new Date(tokenData.refreshTime).toLocaleString()}<br>ë§Œë£Œ ì‹œê°„: ${new Date(tokenData.expiryTime).toLocaleString()}`;
                    updateTokenStatus('success', message);
                    showToast('í† í°ì´ ì„±ê³µì ìœ¼ë¡œ ê°±ì‹ ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                    log('âœ… í† í° ê°±ì‹  í…ŒìŠ¤íŠ¸ ì„±ê³µ');
                } else {
                    updateTokenStatus('error', 'âŒ í† í° ê°±ì‹  ì‹¤íŒ¨: ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ');
                    showToast('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.', 'warning');
                    log('âŒ í† í° ê°±ì‹  ì‹¤íŒ¨: ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ');
                }
            } catch (error) {
                hideLoadingIndicator();
                log(`âŒ í† í° ê°±ì‹  í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`);
                updateTokenStatus('error', `âŒ í† í° ê°±ì‹  ì‹¤íŒ¨: ${error.message}`);
                showToast('í† í° ê°±ì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // í† í° ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜
        function testTokenExpiry() {
            log('í† í° ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘');
            
            if (!authManager.tokenData) {
                updateTokenStatus('error', 'âŒ ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ');
                showToast('ë¨¼ì € ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            // í† í° ë§Œë£Œ ì‹œê°„ì„ ê³¼ê±°ë¡œ ì„¤ì •
            const originalExpiry = authManager.tokenData.expiryTime;
            authManager.tokenData.expiryTime = Date.now() - 1000;
            
            log(`í† í° ë§Œë£Œ ì‹œê°„ì„ ê³¼ê±°ë¡œ ì„¤ì •: ${new Date(authManager.tokenData.expiryTime).toLocaleString()}`);
            updateTokenStatus('warning', 'âš ï¸ í† í°ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤ (ì‹œë®¬ë ˆì´ì…˜)');
            showToast('í† í°ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê°±ì‹ ì´ í•„ìš”í•©ë‹ˆë‹¤.', 'warning');
            
            // 5ì´ˆ í›„ ì›ë˜ëŒ€ë¡œ ë³µêµ¬
            setTimeout(() => {
                if (authManager.tokenData) {
                    authManager.tokenData.expiryTime = originalExpiry;
                    log('í† í° ë§Œë£Œ ì‹œê°„ ë³µêµ¬ë¨');
                    updateTokenStatus('info', 'â„¹ï¸ í† í° ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜ ì¢…ë£Œ');
                }
            }, 5000);
        }
        
        // ìë™ ê°±ì‹  ìŠ¤ì¼€ì¤„ë§ í…ŒìŠ¤íŠ¸
        function testAutoRefreshScheduling() {
            log('ìë™ ê°±ì‹  ìŠ¤ì¼€ì¤„ë§ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            if (!authManager.tokenData) {
                updateTokenStatus('error', 'âŒ ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ');
                showToast('ë¨¼ì € ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }
            
            const expiryTime = authManager.tokenData.expiryTime;
            const now = Date.now();
            const timeUntilExpiry = expiryTime - now;
            const refreshTime = expiryTime - (5 * 60 * 1000); // ë§Œë£Œ 5ë¶„ ì „
            const timeUntilRefresh = refreshTime - now;
            
            let message = `<strong>í† í° ë§Œë£Œ ì‹œê°„:</strong> ${new Date(expiryTime).toLocaleString()}<br>`;
            message += `<strong>ë§Œë£Œê¹Œì§€ ë‚¨ì€ ì‹œê°„:</strong> ${Math.floor(timeUntilExpiry / 1000 / 60)}ë¶„<br>`;
            message += `<strong>ìë™ ê°±ì‹  ì˜ˆì • ì‹œê°„:</strong> ${new Date(refreshTime).toLocaleString()}<br>`;
            message += `<strong>ê°±ì‹ ê¹Œì§€ ë‚¨ì€ ì‹œê°„:</strong> ${Math.floor(timeUntilRefresh / 1000 / 60)}ë¶„`;
            
            if (timeUntilRefresh < 0) {
                message += `<br><strong style="color: #dc3545;">âš ï¸ ê°±ì‹ ì´ í•„ìš”í•©ë‹ˆë‹¤!</strong>`;
                updateTokenStatus('warning', message);
            } else {
                message += `<br><strong style="color: #28a745;">âœ… ìë™ ê°±ì‹  ìŠ¤ì¼€ì¤„ë§ í™œì„±</strong>`;
                updateTokenStatus('success', message);
            }
            
            log(`ìë™ ê°±ì‹  ìŠ¤ì¼€ì¤„ë§ ì •ë³´: ê°±ì‹ ê¹Œì§€ ${Math.floor(timeUntilRefresh / 1000 / 60)}ë¶„`);
        }
        
        // ===== ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜ í•¨ìˆ˜ =====
        
        // ì „ì²´ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜
        async function simulateFullMigration() {
            log('=== ì „ì²´ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘ ===');
            
            try {
                // 1ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
                log('1ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±');
                createTestData();
                await sleep(1000);
                
                // 2ë‹¨ê³„: ë°±ì—… ìƒì„±
                log('2ë‹¨ê³„: ë°±ì—… ìƒì„±');
                showMigrationProgress('checking');
                await testBackupCreation();
                await sleep(2000);
                
                // 3ë‹¨ê³„: ë°ì´í„° ì´ì „
                log('3ë‹¨ê³„: ë°ì´í„° ì´ì „');
                showMigrationProgress('migrating');
                await testDataTransfer();
                await sleep(2000);
                
                // 4ë‹¨ê³„: ë°ì´í„° ê²€ì¦
                log('4ë‹¨ê³„: ë°ì´í„° ê²€ì¦');
                await testDataVerification();
                await sleep(1000);
                
                // 5ë‹¨ê³„: ì™„ë£Œ
                log('5ë‹¨ê³„: ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ');
                showMigrationProgress('complete');
                
                log('=== ì „ì²´ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ ===');
                updateMigrationStatus('success', 'âœ… ì „ì²´ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜ ì„±ê³µ');
            } catch (error) {
                log(`âŒ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜ ì‹¤íŒ¨: ${error.message}`);
                updateMigrationStatus('error', `âŒ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨: ${error.message}`);
                showToast('ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë®¬ë ˆì´ì…˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // ë°±ì—… ìƒì„± í…ŒìŠ¤íŠ¸
        async function testBackupCreation() {
            log('ë°±ì—… ìƒì„± í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            const currentUser = localStorage.getItem('dualTextWriter_currentUser');
            if (!currentUser) {
                log('âŒ í˜„ì¬ ì‚¬ìš©ì ì—†ìŒ');
                updateMigrationStatus('error', 'âŒ í˜„ì¬ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            const savedTextsKey = `dualTextWriter_savedTexts_${currentUser}`;
            const savedTexts = JSON.parse(localStorage.getItem(savedTextsKey) || '[]');
            
            const backup = {
                key: `dualTextWriter_backup_${Date.now()}`,
                timestamp: Date.now(),
                username: currentUser,
                data: savedTexts
            };
            
            localStorage.setItem(backup.key, JSON.stringify(backup));
            
            log(`âœ… ë°±ì—… ìƒì„± ì™„ë£Œ: ${backup.key} (${savedTexts.length}ê°œ í•­ëª©)`);
            updateMigrationStatus('success', `âœ… ë°±ì—… ìƒì„± ì™„ë£Œ: ${savedTexts.length}ê°œ í•­ëª©`);
            showToast('ë°±ì—…ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }
        
        // ë°ì´í„° ì´ì „ í…ŒìŠ¤íŠ¸
        async function testDataTransfer() {
            log('ë°ì´í„° ì´ì „ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            const oldUsername = localStorage.getItem('dualTextWriter_currentUser');
            if (!oldUsername) {
                log('âŒ ì›ë³¸ ì‚¬ìš©ì ì—†ìŒ');
                updateMigrationStatus('error', 'âŒ ì›ë³¸ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            const newEmail = 'test_migration@example.com';
            const oldKey = `dualTextWriter_savedTexts_${oldUsername}`;
            const newKey = `dualTextWriter_savedTexts_${newEmail}`;
            
            const oldData = JSON.parse(localStorage.getItem(oldKey) || '[]');
            localStorage.setItem(newKey, JSON.stringify(oldData));
            
            log(`âœ… ë°ì´í„° ì´ì „ ì™„ë£Œ: ${oldUsername} â†’ ${newEmail} (${oldData.length}ê°œ í•­ëª©)`);
            updateMigrationStatus('success', `âœ… ë°ì´í„° ì´ì „ ì™„ë£Œ: ${oldData.length}ê°œ í•­ëª©`);
            showToast('ë°ì´í„°ê°€ ì´ì „ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }
        
        // ë°ì´í„° ê²€ì¦ í…ŒìŠ¤íŠ¸
        async function testDataVerification() {
            log('ë°ì´í„° ê²€ì¦ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            const oldUsername = localStorage.getItem('dualTextWriter_currentUser');
            const newEmail = 'test_migration@example.com';
            
            const oldKey = `dualTextWriter_savedTexts_${oldUsername}`;
            const newKey = `dualTextWriter_savedTexts_${newEmail}`;
            
            const oldData = JSON.parse(localStorage.getItem(oldKey) || '[]');
            const newData = JSON.parse(localStorage.getItem(newKey) || '[]');
            
            const isValid = oldData.length === newData.length && 
                           JSON.stringify(oldData) === JSON.stringify(newData);
            
            if (isValid) {
                log(`âœ… ë°ì´í„° ê²€ì¦ ì„±ê³µ: ${oldData.length}ê°œ í•­ëª© ì¼ì¹˜`);
                updateMigrationStatus('success', `âœ… ë°ì´í„° ê²€ì¦ ì„±ê³µ: ${oldData.length}ê°œ í•­ëª©`);
                showToast('ë°ì´í„° ë¬´ê²°ì„±ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } else {
                log(`âŒ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨: ì›ë³¸ ${oldData.length}ê°œ, ëŒ€ìƒ ${newData.length}ê°œ`);
                updateMigrationStatus('error', 'âŒ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨');
                showToast('ë°ì´í„° ê²€ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
        
        // ë¡¤ë°± í…ŒìŠ¤íŠ¸
        async function testRollback() {
            log('ë¡¤ë°± í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            // ê°€ì¥ ìµœê·¼ ë°±ì—… ì°¾ê¸°
            const backupKeys = Object.keys(localStorage).filter(key => 
                key.startsWith('dualTextWriter_backup_')
            );
            
            if (backupKeys.length === 0) {
                log('âŒ ë°±ì—… ë°ì´í„° ì—†ìŒ');
                updateMigrationStatus('error', 'âŒ ë°±ì—… ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤');
                showToast('ë°±ì—… ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', 'warning');
                return;
            }
            
            const latestBackupKey = backupKeys.sort().reverse()[0];
            const backup = JSON.parse(localStorage.getItem(latestBackupKey));
            
            // ë°±ì—…ì—ì„œ ë³µì›
            const restoreKey = `dualTextWriter_savedTexts_${backup.username}`;
            localStorage.setItem(restoreKey, JSON.stringify(backup.data));
            
            log(`âœ… ë¡¤ë°± ì™„ë£Œ: ${backup.key} â†’ ${restoreKey} (${backup.data.length}ê°œ í•­ëª©)`);
            updateMigrationStatus('success', `âœ… ë¡¤ë°± ì™„ë£Œ: ${backup.data.length}ê°œ í•­ëª© ë³µì›`);
            showToast('ë°±ì—…ì—ì„œ ë°ì´í„°ê°€ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }
        
        // ===== ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ =====
        
        // ì„¤ì • ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤
        function testConfigError() {
            log('ì„¤ì • ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸');
            
            const errorScenarios = [
                { type: 'PLACEHOLDER_VALUE', message: 'Client IDì— í”Œë ˆì´ìŠ¤í™€ë”ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.' },
                { type: 'INVALID_FORMAT', message: 'Client ID í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.' },
                { type: 'HTTPS_REQUIRED', message: 'í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” HTTPSê°€ í•„ìš”í•©ë‹ˆë‹¤.' }
            ];
            
            const scenario = errorScenarios[Math.floor(Math.random() * errorScenarios.length)];
            
            log(`âŒ ì„¤ì • ì˜¤ë¥˜: ${scenario.type}`);
            updateErrorStatus('error', `âŒ ${scenario.message}`);
            showToast(scenario.message, 'error');
            
            setTimeout(() => {
                log('ì„¤ì • ì•ˆë‚´ í‘œì‹œ');
                showToast('ì„¤ì • ê°€ì´ë“œë¥¼ í™•ì¸í•˜ì„¸ìš”.', 'info');
            }, 2000);
        }
        
        // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤
        function testNetworkError() {
            log('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸');
            
            updateErrorStatus('error', 'âŒ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
            showToast('ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.', 'warning');
            
            log('âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë°œìƒ');
            
            setTimeout(() => {
                log('ì¬ì‹œë„ ì˜µì…˜ ì œê³µ');
                if (confirm('ë‹¤ì‹œ ì‹œë„í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    log('ì‚¬ìš©ìê°€ ì¬ì‹œë„ ì„ íƒ');
                    showToast('ì¬ì‹œë„ ì¤‘...', 'info');
                } else {
                    log('ì‚¬ìš©ìê°€ ì¬ì‹œë„ ì·¨ì†Œ');
                }
            }, 2000);
        }
        
        // ì‚¬ìš©ì ì·¨ì†Œ ì‹œë‚˜ë¦¬ì˜¤
        function testUserCancellation() {
            log('ì‚¬ìš©ì ì·¨ì†Œ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸');
            
            updateErrorStatus('info', 'â„¹ï¸ ë¡œê·¸ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            showToast('ë¡œê·¸ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
            
            log('â„¹ï¸ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ íŒì—…ì„ ë‹«ìŒ (ì˜¤ë¥˜ ì•„ë‹˜)');
        }
        
        // í† í° ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤
        function testTokenError() {
            log('í† í° ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸');
            
            const errorTypes = [
                { type: 'token_expired', message: 'ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.', action: 'ìë™ ê°±ì‹  ì‹œë„' },
                { type: 'invalid_token', message: 'ìœ íš¨í•˜ì§€ ì•Šì€ ì¸ì¦ ì •ë³´ì…ë‹ˆë‹¤.', action: 'ì¬ë¡œê·¸ì¸ í•„ìš”' }
            ];
            
            const error = errorTypes[Math.floor(Math.random() * errorTypes.length)];
            
            log(`âŒ í† í° ì˜¤ë¥˜: ${error.type}`);
            updateErrorStatus('error', `âŒ ${error.message}`);
            showToast(error.message, 'error');
            
            setTimeout(() => {
                log(`ì•¡ì…˜: ${error.action}`);
                showToast(error.action, 'info');
            }, 2000);
        }
        
        // ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤
        function testMigrationFailure() {
            log('ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸');
            
            showMigrationProgress('migrating');
            
            setTimeout(() => {
                log('âŒ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨ ë°œìƒ');
                updateErrorStatus('error', 'âŒ ë§ˆì´ê·¸ë ˆì´ì…˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë°±ì—…ì—ì„œ ë³µì› ì¤‘...');
                showToast('ë§ˆì´ê·¸ë ˆì´ì…˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                
                // ì§„í–‰ í‘œì‹œ ì œê±°
                const progressEl = document.getElementById('test-migration-progress');
                if (progressEl) progressEl.remove();
                
                setTimeout(() => {
                    log('âœ… ë°±ì—…ì—ì„œ ë°ì´í„° ë³µì› ì™„ë£Œ');
                    showToast('ë°±ì—…ì—ì„œ ë°ì´í„°ê°€ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                }, 2000);
            }, 3000);
        }
        
        // ì˜¤ë¥˜ ë³µêµ¬ í…ŒìŠ¤íŠ¸
        function testErrorRecovery() {
            log('ì˜¤ë¥˜ ë³µêµ¬ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            // 1ë‹¨ê³„: ì˜¤ë¥˜ ë°œìƒ
            log('1ë‹¨ê³„: ì˜¤ë¥˜ ë°œìƒ ì‹œë®¬ë ˆì´ì…˜');
            updateErrorStatus('error', 'âŒ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            showToast('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            
            setTimeout(() => {
                // 2ë‹¨ê³„: í´ë°± ì‹œìŠ¤í…œ í™œì„±í™”
                log('2ë‹¨ê³„: í´ë°± ì‹œìŠ¤í…œ í™œì„±í™”');
                updateErrorStatus('warning', 'âš ï¸ í´ë°± ì‹œìŠ¤í…œìœ¼ë¡œ ì „í™˜ ì¤‘...');
                showToast('ê¸°ì¡´ ë¡œê·¸ì¸ ë°©ì‹ìœ¼ë¡œ ì „í™˜í•©ë‹ˆë‹¤.', 'warning');
                
                setTimeout(() => {
                    // 3ë‹¨ê³„: ë³µêµ¬ ì™„ë£Œ
                    log('3ë‹¨ê³„: ë³µêµ¬ ì™„ë£Œ');
                    updateErrorStatus('success', 'âœ… í´ë°± ì‹œìŠ¤í…œìœ¼ë¡œ ì •ìƒ ì‘ë™ ì¤‘');
                    showToast('ì •ìƒì ìœ¼ë¡œ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                }, 2000);
            }, 2000);
        }
        
        function updateErrorStatus(type, message) {
            document.getElementById('error-status').innerHTML = 
                `<div class="status ${type}">${message}</div>`;
        }
        
        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        // í† í° ê°±ì‹  (ê¸°ì¡´ í•¨ìˆ˜ ìœ ì§€)
        async function refreshToken() {
            await testTokenRefresh();
        }
        
        // í† í° ê²€ì¦
        function validateToken() {
            const isValid = authManager.validateToken();
            updateTokenStatus(isValid ? 'success' : 'error', `í† í° ìœ íš¨ì„±: ${isValid ? 'âœ… ìœ íš¨' : 'âŒ ë¬´íš¨'}`);
            log(`í† í° ê²€ì¦: ${isValid ? 'ìœ íš¨' : 'ë¬´íš¨'}`);
        }
        
        // ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒíƒœ í™•ì¸
        function checkMigrationStatus() {
            const status = migrationManager.getMigrationStatus();
            
            let html = `<div class="status info">`;
            html += `<strong>ë§ˆì´ê·¸ë ˆì´ì…˜ ê¸°ë¡:</strong> ${status.hasMigrationRecord ? 'âœ… ìˆìŒ' : 'âŒ ì—†ìŒ'}<br>`;
            html += `<strong>ë°±ì—… ë°ì´í„°:</strong> ${status.hasBackup ? 'âœ… ìˆìŒ' : 'âŒ ì—†ìŒ'}<br>`;
            
            if (status.migrationRecord) {
                html += `<strong>ì´ì „ ì‚¬ìš©ì:</strong> ${status.migrationRecord.oldUsername}<br>`;
                html += `<strong>ìƒˆ ì´ë©”ì¼:</strong> ${status.migrationRecord.newEmail}<br>`;
                html += `<strong>ì´ì „ ë°ì´í„°:</strong> ${status.migrationRecord.dataCount}ê°œ<br>`;
                html += `<strong>ì´ì „ ì‹œê°„:</strong> ${new Date(status.migrationRecord.migratedAt).toLocaleString()}`;
            }
            
            html += '</div>';
            document.getElementById('migration-status').innerHTML = html;
            
            log('ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒíƒœ í™•ì¸ ì™„ë£Œ');
        }
        
        // í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
        function createTestData() {
            const testUsername = 'test_user_' + Date.now();
            const testData = [
                {
                    id: Date.now(),
                    content: 'í…ŒìŠ¤íŠ¸ ë ˆí¼ëŸ°ìŠ¤ ê¸€ì…ë‹ˆë‹¤.',
                    date: new Date().toLocaleString('ko-KR'),
                    characterCount: 15,
                    type: 'reference'
                },
                {
                    id: Date.now() + 1,
                    content: 'í…ŒìŠ¤íŠ¸ ìˆ˜ì • ê¸€ì…ë‹ˆë‹¤.',
                    date: new Date().toLocaleString('ko-KR'),
                    characterCount: 12,
                    type: 'edit'
                }
            ];
            
            localStorage.setItem(`dualTextWriter_savedTexts_${testUsername}`, JSON.stringify(testData));
            localStorage.setItem('dualTextWriter_currentUser', testUsername);
            localStorage.setItem('dualTextWriter_authProvider', 'username');
            
            log(`í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±: ${testUsername} (${testData.length}ê°œ ê¸€)`);
            updateMigrationStatus('success', `í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±ë¨: ${testUsername}`);
        }
        
        // í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ
        function clearTestData() {
            const keys = Object.keys(localStorage).filter(key => 
                key.startsWith('dualTextWriter_') || key.startsWith('test_user_')
            );
            
            keys.forEach(key => localStorage.removeItem(key));
            
            log(`í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ: ${keys.length}ê°œ í•­ëª©`);
            updateMigrationStatus('info', 'í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œë¨');
        }
        
        // ìƒíƒœ ì—…ë°ì´íŠ¸ í—¬í¼
        function updateAuthStatus(type, message) {
            document.getElementById('auth-status').innerHTML = 
                `<div class="status ${type}">${message}</div>`;
        }
        
        function updateTokenStatus(type, message) {
            document.getElementById('token-status').innerHTML = 
                `<div class="status ${type}">${message}</div>`;
        }
        
        function updateMigrationStatus(type, message) {
            document.getElementById('migration-status').innerHTML = 
                `<div class="status ${type}">${message}</div>`;
        }
        
        // ë¡œê·¸ í•¨ìˆ˜
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logContainer = document.getElementById('log-container');
            logContainer.innerHTML += `[${timestamp}] ${message}\n`;
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        // ë¡œê·¸ ì§€ìš°ê¸°
        function clearLog() {
            document.getElementById('log-container').innerHTML = '';
        }
        
        // ===== UX ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (Task 5) =====
        
        // ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ í…ŒìŠ¤íŠ¸
        function testLoadingAnimation() {
            log('ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            // ë¡œë”© í‘œì‹œ
            showLoadingIndicator('í…ŒìŠ¤íŠ¸ ë¡œë”© ì¤‘...');
            
            // 3ì´ˆ í›„ ìë™ ìˆ¨ê¹€
            setTimeout(() => {
                hideLoadingIndicator();
                log('ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ í…ŒìŠ¤íŠ¸ ì™„ë£Œ');
            }, 3000);
        }
        
        // ë¡œë”© í‘œì‹œê¸° í‘œì‹œ
        function showLoadingIndicator(message = 'ì²˜ë¦¬ ì¤‘...') {
            hideLoadingIndicator();
            
            const loadingEl = document.createElement('div');
            loadingEl.id = 'test-loading-indicator';
            loadingEl.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.85);
                color: white;
                padding: 30px 40px;
                border-radius: 12px;
                box-shadow: 0 8px 24px rgba(0,0,0,0.3);
                z-index: 2000;
                text-align: center;
                min-width: 250px;
                animation: fadeIn 0.3s ease;
            `;
            
            loadingEl.innerHTML = `
                <div style="
                    border: 4px solid rgba(255, 255, 255, 0.3);
                    border-top: 4px solid white;
                    border-radius: 50%;
                    width: 40px;
                    height: 40px;
                    animation: spin 1s linear infinite;
                    margin: 0 auto 15px;
                "></div>
                <div style="font-size: 16px; font-weight: 600;">${message}</div>
            `;
            
            document.body.appendChild(loadingEl);
            
            // ìŠ¤í”¼ë„ˆ ì• ë‹ˆë©”ì´ì…˜
            if (!document.getElementById('test-spinner-style')) {
                const style = document.createElement('style');
                style.id = 'test-spinner-style';
                style.textContent = `
                    @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                    }
                    @keyframes fadeIn {
                        from { opacity: 0; }
                        to { opacity: 1; }
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // ë¡œë”© í‘œì‹œê¸° ìˆ¨ê¸°ê¸°
        function hideLoadingIndicator() {
            const loadingEl = document.getElementById('test-loading-indicator');
            if (loadingEl && loadingEl.parentNode) {
                loadingEl.parentNode.removeChild(loadingEl);
            }
        }
        
        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í…ŒìŠ¤íŠ¸
        function testToastSuccess() {
            showToast('ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            log('í† ìŠ¤íŠ¸ (ì„±ê³µ) í…ŒìŠ¤íŠ¸');
        }
        
        function testToastWarning() {
            showToast('ì£¼ì˜ê°€ í•„ìš”í•œ ìƒí™©ì…ë‹ˆë‹¤.', 'warning');
            log('í† ìŠ¤íŠ¸ (ê²½ê³ ) í…ŒìŠ¤íŠ¸');
        }
        
        function testToastError() {
            showToast('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
            log('í† ìŠ¤íŠ¸ (ì˜¤ë¥˜) í…ŒìŠ¤íŠ¸');
        }
        
        function testToastInfo() {
            showToast('ì •ë³´ì„± ë©”ì‹œì§€ì…ë‹ˆë‹¤.', 'info');
            log('í† ìŠ¤íŠ¸ (ì •ë³´) í…ŒìŠ¤íŠ¸');
        }
        
        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
        function showToast(message, type = 'info') {
            const messageConfig = {
                'success': { icon: 'âœ…', bgColor: '#28a745', textColor: 'white', duration: 3000 },
                'error': { icon: 'âŒ', bgColor: '#dc3545', textColor: 'white', duration: 5000 },
                'warning': { icon: 'âš ï¸', bgColor: '#ffc107', textColor: '#000', duration: 4000 },
                'info': { icon: 'â„¹ï¸', bgColor: '#17a2b8', textColor: 'white', duration: 3000 }
            };
            
            const config = messageConfig[type] || messageConfig['info'];
            
            const messageEl = document.createElement('div');
            messageEl.className = 'test-toast-message';
            messageEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${config.bgColor};
                color: ${config.textColor};
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 1000;
                font-weight: 600;
                max-width: 350px;
                word-wrap: break-word;
                display: flex;
                align-items: center;
                gap: 10px;
                animation: slideIn 0.3s ease;
            `;
            
            messageEl.innerHTML = `
                <span style="font-size: 1.2em;">${config.icon}</span>
                <span style="flex: 1;">${message}</span>
                <button style="
                    background: none;
                    border: none;
                    color: inherit;
                    font-size: 1.2em;
                    cursor: pointer;
                    padding: 0;
                    margin-left: auto;
                    opacity: 0.7;
                " onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'">Ã—</button>
            `;
            
            document.body.appendChild(messageEl);
            
            // ë‹«ê¸° ë²„íŠ¼
            const closeBtn = messageEl.querySelector('button');
            const removeToast = () => {
                messageEl.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (messageEl.parentNode) {
                        messageEl.parentNode.removeChild(messageEl);
                    }
                }, 300);
            };
            
            closeBtn.addEventListener('click', removeToast);
            
            // ìë™ ì‚¬ë¼ì§
            const autoHideTimeout = setTimeout(removeToast, config.duration);
            
            // ë§ˆìš°ìŠ¤ í˜¸ë²„ ì‹œ íƒ€ì´ë¨¸ ì¼ì‹œ ì •ì§€
            messageEl.addEventListener('mouseenter', () => {
                clearTimeout(autoHideTimeout);
            });
            
            messageEl.addEventListener('mouseleave', () => {
                setTimeout(removeToast, 1000);
            });
            
            // ì• ë‹ˆë©”ì´ì…˜ ìŠ¤íƒ€ì¼ ì¶”ê°€
            if (!document.getElementById('test-toast-style')) {
                const style = document.createElement('style');
                style.id = 'test-toast-style';
                style.textContent = `
                    @keyframes slideIn {
                        from {
                            opacity: 0;
                            transform: translateX(100%);
                        }
                        to {
                            opacity: 1;
                            transform: translateX(0);
                        }
                    }
                    @keyframes slideOut {
                        from {
                            opacity: 1;
                            transform: translateX(0);
                        }
                        to {
                            opacity: 0;
                            transform: translateX(100%);
                        }
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // ë§ˆì´ê·¸ë ˆì´ì…˜ ì§„í–‰ í‘œì‹œ í…ŒìŠ¤íŠ¸
        function testMigrationProgress() {
            log('ë§ˆì´ê·¸ë ˆì´ì…˜ ì§„í–‰ í‘œì‹œ í…ŒìŠ¤íŠ¸ ì‹œì‘');
            
            // 1ë‹¨ê³„: í™•ì¸ ì¤‘
            showMigrationProgress('checking');
            
            setTimeout(() => {
                // 2ë‹¨ê³„: ë§ˆì´ê·¸ë ˆì´ì…˜ ì¤‘
                showMigrationProgress('migrating');
                
                setTimeout(() => {
                    // 3ë‹¨ê³„: ì™„ë£Œ
                    showMigrationProgress('complete');
                    log('ë§ˆì´ê·¸ë ˆì´ì…˜ ì§„í–‰ í‘œì‹œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ');
                }, 2000);
            }, 2000);
        }
        
        // ë§ˆì´ê·¸ë ˆì´ì…˜ ì§„í–‰ í‘œì‹œ
        function showMigrationProgress(status) {
            const existingProgress = document.getElementById('test-migration-progress');
            if (existingProgress) {
                existingProgress.remove();
            }
            
            const statusConfig = {
                'checking': {
                    icon: 'ğŸ”',
                    title: 'ë°ì´í„° í™•ì¸ ì¤‘',
                    text: 'ê¸°ì¡´ ë°ì´í„°ë¥¼ í™•ì¸í•˜ê³  ìˆìŠµë‹ˆë‹¤...',
                    progress: 10,
                    steps: { backup: false, transfer: false, verify: false }
                },
                'migrating': {
                    icon: 'ğŸ“¦',
                    title: 'ë§ˆì´ê·¸ë ˆì´ì…˜ ì§„í–‰ ì¤‘',
                    text: 'ë°ì´í„°ë¥¼ ì•ˆì „í•˜ê²Œ ì´ì „í•˜ê³  ìˆìŠµë‹ˆë‹¤...',
                    progress: 50,
                    steps: { backup: true, transfer: true, verify: false }
                },
                'complete': {
                    icon: 'âœ…',
                    title: 'ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ',
                    text: 'ëª¨ë“  ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì´ì „ë˜ì—ˆìŠµë‹ˆë‹¤!',
                    progress: 100,
                    steps: { backup: true, transfer: true, verify: true }
                }
            };
            
            const config = statusConfig[status];
            if (!config) return;
            
            if (status === 'complete') {
                showToast(config.text, 'success');
                return;
            }
            
            const progressEl = document.createElement('div');
            progressEl.id = 'test-migration-progress';
            progressEl.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.9);
                border-radius: 12px;
                padding: 30px 40px;
                text-align: center;
                z-index: 2000;
                min-width: 400px;
                box-shadow: 0 8px 24px rgba(0,0,0,0.3);
                animation: fadeIn 0.3s ease;
            `;
            
            progressEl.innerHTML = `
                <h4 style="color: white; margin-bottom: 20px; font-size: 1.2rem; font-weight: 600;">
                    ${config.icon} ${config.title}
                </h4>
                <div style="
                    width: 100%;
                    height: 12px;
                    background: rgba(255, 255, 255, 0.2);
                    border-radius: 6px;
                    overflow: hidden;
                    margin-bottom: 15px;
                ">
                    <div style="
                        height: 100%;
                        background: linear-gradient(90deg, #28a745, #20c997);
                        border-radius: 6px;
                        transition: width 0.5s ease;
                        width: ${config.progress}%;
                    "></div>
                </div>
                <div style="color: rgba(255, 255, 255, 0.9); font-size: 1rem; margin-bottom: 10px;">
                    ${config.text}
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 20px; gap: 10px;">
                    <div style="
                        flex: 1;
                        padding: 10px;
                        background: ${config.steps.backup ? 'rgba(40, 167, 69, 0.5)' : 'rgba(255, 255, 255, 0.1)'};
                        border-radius: 8px;
                        font-size: 0.85rem;
                        color: white;
                        transition: all 0.3s ease;
                    ">
                        <span style="font-size: 1.2em; display: block; margin-bottom: 5px;">
                            ${config.steps.backup ? 'âœ…' : 'â³'}
                        </span>
                        ë°±ì—…
                    </div>
                    <div style="
                        flex: 1;
                        padding: 10px;
                        background: ${config.steps.transfer ? 'rgba(40, 167, 69, 0.3)' : 'rgba(255, 255, 255, 0.1)'};
                        border-radius: 8px;
                        font-size: 0.85rem;
                        color: ${config.steps.transfer ? 'white' : 'rgba(255, 255, 255, 0.6)'};
                        font-weight: ${config.steps.transfer ? '600' : 'normal'};
                        transition: all 0.3s ease;
                    ">
                        <span style="font-size: 1.2em; display: block; margin-bottom: 5px;">
                            ${config.steps.transfer ? 'âœ…' : 'â³'}
                        </span>
                        ì´ì „
                    </div>
                    <div style="
                        flex: 1;
                        padding: 10px;
                        background: ${config.steps.verify ? 'rgba(40, 167, 69, 0.5)' : 'rgba(255, 255, 255, 0.1)'};
                        border-radius: 8px;
                        font-size: 0.85rem;
                        color: ${config.steps.verify ? 'white' : 'rgba(255, 255, 255, 0.6)'};
                        transition: all 0.3s ease;
                    ">
                        <span style="font-size: 1.2em; display: block; margin-bottom: 5px;">
                            ${config.steps.verify ? 'âœ…' : 'â³'}
                        </span>
                        ê²€ì¦
                    </div>
                </div>
            `;
            
            document.body.appendChild(progressEl);
        }
    </script>
</body>
</html>