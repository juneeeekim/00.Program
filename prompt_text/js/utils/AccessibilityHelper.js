class AccessibilityHelper{static RGB_MAX_VALUE = 255;static LUMINANCE_THRESHOLD = 0.03928;static LUMINANCE_DIVISOR = 12.92;static LUMINANCE_OFFSET = 0.055;static LUMINANCE_DENOMINATOR = 1.055;static LUMINANCE_GAMMA = 2.4;static CONTRAST_OFFSET = 0.05;constructor(){this.focusTrapStack = [];this.previousFocusElement = null;this.keyboardNavigationEnabled = true;this.init()}init(){this.setupKeyboardNavigation();this.setupFocusManagement();this.setupSkipLinks()}setAriaAttributes(element, attributes){if (!element) return;Object.entries(attributes).forEach(([key, value]) =>{if (value !== null && value !== undefined){element.setAttribute(`aria-${key}`, value)}})}addButtonLabel(button, label){if (!button || !label) return;if (!button.textContent.trim()){button.setAttribute('aria-label', label)}if (button.tagName !== 'BUTTON'){button.setAttribute('role', 'button');button.setAttribute('tabindex', '0')}}addLinkLabel(link, label){if (!link || !label) return;if (!link.textContent.trim()){link.setAttribute('aria-label', label)}}addInputDescription(input, description){if (!input || !description) return;const descId = `${input.id || 'input'}-description`;let descElement = document.getElementById(descId);if (!descElement){descElement = document.createElement('div');descElement.id = descId;descElement.className = 'sr-only';descElement.textContent = description;input.parentNode.insertBefore(descElement, input.nextSibling)}input.setAttribute('aria-describedby', descId)}setupModalAccessibility(modal, title){if (!modal) return;this.setAriaAttributes(modal,{role: 'dialog', modal: 'true', labelledby: `${modal.id}-title`, describedby: `${modal.id}-description`});const titleElement = modal.querySelector('h1, h2, h3, .modal-title');if (titleElement){titleElement.id = `${modal.id}-title`}this.trapFocus(modal)}setupAlertAccessibility(alert, type = 'polite'){if (!alert) return;this.setAriaAttributes(alert,{live: type, atomic: 'true', role: 'alert'})}setupKeyboardNavigation(){document.addEventListener('keydown', (e) =>{if (!this.keyboardNavigationEnabled) return;if (e.key === 'Escape'){this.handleEscapeKey(e)}if (e.key === 'Enter' || e.key === ' '){this.handleActivationKey(e)}if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)){this.handleArrowKey(e)}})}handleEscapeKey(e){const openModal = document.querySelector('[role="dialog"][aria-modal="true"]:not([hidden])');if (openModal){e.preventDefault();const closeButton = openModal.querySelector('[data-dismiss="modal"], .modal-close, .close');if (closeButton){closeButton.click()}this.restoreFocus()}}handleActivationKey(e){const target = e.target;if (target.getAttribute('role') === 'button' && target.tagName !== 'BUTTON'){e.preventDefault();target.click()}}handleArrowKey(e){const target = e.target;const container = target.closest('[role="listbox"], [role="menu"], [role="radiogroup"], [role="tablist"]');if (container){e.preventDefault();this.navigateWithArrows(container, e.key)}}navigateWithArrows(container, key){const items = Array.from( container.querySelectorAll('[role="option"], [role="menuitem"], [role="radio"], [role="tab"]') );const currentIndex = items.indexOf(document.activeElement);let nextIndex;if (key === 'ArrowDown' || key === 'ArrowRight'){nextIndex = (currentIndex + 1) % items.length}else if (key === 'ArrowUp' || key === 'ArrowLeft'){nextIndex = (currentIndex - 1 + items.length) % items.length}if (nextIndex !== undefined && items[nextIndex]){items[nextIndex].focus()}}setupFocusManagement(){const style = document.createElement('style');style.textContent = ` *:focus{outline: 2px solid #2196F3;outline-offset: 2px}*:focus:not(:focus-visible){outline: none}.sr-only{position: absolute;width: 1px;height: 1px;padding: 0;margin: -1px;overflow: hidden;clip: rect(0, 0, 0, 0);white-space: nowrap;border: 0}.skip-link{position: absolute;top: -40px;left: 0;background: #2196F3;color: white;padding: 8px;text-decoration: none;z-index: 100}.skip-link:focus{top: 0}`;document.head.appendChild(style)}trapFocus(container){if (!container) return;const focusableElements = container.querySelectorAll( 'a[href], button:not([disabled]), textarea:not([disabled]), ' + 'input:not([disabled]), select:not([disabled]), ' + '[tabindex]:not([tabindex="-1"])' );if (focusableElements.length === 0) return;const firstElement = focusableElements[0];const lastElement = focusableElements[focusableElements.length - 1];this.previousFocusElement = document.activeElement;firstElement.focus();const trapHandler = (e) =>{if (e.key !== 'Tab') return;if (e.shiftKey){if (document.activeElement === firstElement){e.preventDefault();lastElement.focus()}}else{if (document.activeElement === lastElement){e.preventDefault();firstElement.focus()}}};container.addEventListener('keydown', trapHandler);this.focusTrapStack.push({container, handler: trapHandler})}releaseFocusTrap(container){const index = this.focusTrapStack.findIndex((trap) => trap.container === container);if (index !== -1){const trap = this.focusTrapStack[index];trap.container.removeEventListener('keydown', trap.handler);this.focusTrapStack.splice(index, 1)}}restoreFocus(){if (this.previousFocusElement){this.previousFocusElement.focus();this.previousFocusElement = null}}setupSkipLinks(){const mainContent = document.querySelector('main, [role="main"], #main-content');if (mainContent && !mainContent.id){mainContent.id = 'main-content'}if (!document.querySelector('.skip-link')){const skipLink = document.createElement('a');skipLink.href = '#main-content';skipLink.className = 'skip-link';skipLink.textContent = '본문으로 건너뛰기';document.body.insertBefore(skipLink, document.body.firstChild)}}checkColorContrast(foreground, background){const getLuminance = (hex) =>{const rgb = parseInt(hex.slice(1), 16);const redValue = (rgb >> 16) & 0xff;const greenValue = (rgb >> 8) & 0xff;const blueValue = (rgb >> 0) & 0xff;const [rs, gs, bs] = [redValue, greenValue, blueValue].map((colorValue) =>{const normalizedColor = colorValue / AccessibilityHelper.RGB_MAX_VALUE;const threshold = AccessibilityHelper.LUMINANCE_THRESHOLD;const divisor = AccessibilityHelper.LUMINANCE_DIVISOR;const offset = AccessibilityHelper.LUMINANCE_OFFSET;const denominator = AccessibilityHelper.LUMINANCE_DENOMINATOR;const gamma = AccessibilityHelper.LUMINANCE_GAMMA;return normalizedColor <= threshold ? normalizedColor / divisor : Math.pow((normalizedColor + offset) / denominator, gamma)});return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs};const l1 = getLuminance(foreground);const l2 = getLuminance(background);const offset = AccessibilityHelper.CONTRAST_OFFSET;const ratio = (Math.max(l1, l2) + offset) / (Math.min(l1, l2) + offset);return{ratio: ratio.toFixed(2), passAA: ratio >= 4.5, passAALarge: ratio >= 3, passAAA: ratio >= 7, passAAALarge: ratio >= 4.5}}addScreenReaderText(element, text){if (!element || !text) return;const srText = document.createElement('span');srText.className = 'sr-only';srText.textContent = text;element.appendChild(srText)}cleanup(){this.focusTrapStack.forEach((trap) =>{trap.container.removeEventListener('keydown', trap.handler)});this.focusTrapStack = []}}const accessibilityHelper = new AccessibilityHelper();export default accessibilityHelper;if (typeof module !== 'undefined' && module.exports){module.exports = accessibilityHelper}