class FeedbackFormUI{constructor(options ={}){this.container = options.container;this.maxLength = options.maxLength || 500;this.autoSave = options.autoSave || false;this.autoSaveDelay = options.autoSaveDelay || 3000;this.onSave = options.onSave || null;this.onChange = options.onChange || null;this.feedback ={positive: '', negative: '', suggestion: ''};this.autoSaveTimer = null;this.lastSaved = null;if (!this.container){throw new Error('container ìš”ì†Œê°€ í•„ìš”í•©ë‹ˆë‹¤.')}this.init()}init(){this.render();this.initEventListeners();this.addStyles()}render(){this.container.innerHTML = ` <div class="feedback-form"> <div class="feedback-form-header"> <h3>í”¼ë“œë°± ì‘ì„±</h3> <p class="feedback-form-description"> ì‹¤í–‰ ê²°ê³¼ì— ëŒ€í•œ ì˜ê²¬ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”. (ì„ íƒ ì‚¬í•­) </p> </div> <div class="feedback-form-body"> <!-- ê¸ì •ì  í”¼ë“œë°± --> <div class="feedback-field"> <label for="feedback-positive" class="feedback-label"> <span class="label-icon">ğŸ‘</span> <span class="label-text">ì¢‹ì•˜ë˜ ì </span> <span class="label-optional">(ì„ íƒ)</span> </label> <textarea id="feedback-positive" class="feedback-textarea" placeholder="ì˜ ì‘ë™í•œ ë¶€ë¶„ì´ë‚˜ ë§Œì¡±ìŠ¤ëŸ¬ìš´ ì ì„ ì•Œë ¤ì£¼ì„¸ìš”..." maxlength="${this.maxLength}" rows="4" aria-describedby="positive-help positive-count" ></textarea> <div class="feedback-meta"> <span id="positive-help" class="feedback-help"> ì˜ˆ: ì‘ë‹µì´ ì •í™•í–ˆì–´ìš”, ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ì—ˆì–´ìš” </span> <span id="positive-count" class="feedback-count"> <span class="count-current">0</span> / ${this.maxLength}</span> </div> </div> <!-- ë¶€ì •ì  í”¼ë“œë°± --> <div class="feedback-field"> <label for="feedback-negative" class="feedback-label"> <span class="label-icon">ğŸ‘</span> <span class="label-text">ì•„ì‰¬ìš´ ì </span> <span class="label-optional">(ì„ íƒ)</span> </label> <textarea id="feedback-negative" class="feedback-textarea" placeholder="ê°œì„ ì´ í•„ìš”í•œ ë¶€ë¶„ì´ë‚˜ ë¬¸ì œì ì„ ì•Œë ¤ì£¼ì„¸ìš”..." maxlength="${this.maxLength}" rows="4" aria-describedby="negative-help negative-count" ></textarea> <div class="feedback-meta"> <span id="negative-help" class="feedback-help"> ì˜ˆ: ì‘ë‹µì´ ë¶€ì •í™•í–ˆì–´ìš”, ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš” </span> <span id="negative-count" class="feedback-count"> <span class="count-current">0</span> / ${this.maxLength}</span> </div> </div> <!-- ì œì•ˆ --> <div class="feedback-field"> <label for="feedback-suggestion" class="feedback-label"> <span class="label-icon">ğŸ’¡</span> <span class="label-text">ê°œì„  ì œì•ˆ</span> <span class="label-optional">(ì„ íƒ)</span> </label> <textarea id="feedback-suggestion" class="feedback-textarea" placeholder="ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ìœ„í•œ ì œì•ˆì„ í•´ì£¼ì„¸ìš”..." maxlength="${this.maxLength}" rows="4" aria-describedby="suggestion-help suggestion-count" ></textarea> <div class="feedback-meta"> <span id="suggestion-help" class="feedback-help"> ì˜ˆ: ì´ëŸ° ê¸°ëŠ¥ì´ ìˆìœ¼ë©´ ì¢‹ê² ì–´ìš”, ì´ë ‡ê²Œ ë°”ê¾¸ë©´ ë” ì¢‹ì„ ê²ƒ ê°™ì•„ìš” </span> <span id="suggestion-count" class="feedback-count"> <span class="count-current">0</span> / ${this.maxLength}</span> </div> </div> </div> <div class="feedback-form-footer"> <div class="feedback-status"> <span id="feedback-status-text" class="status-text"></span> </div> <div class="feedback-actions"> <button type="button" class="btn-clear" id="feedback-clear"> ì´ˆê¸°í™” </button> <button type="button" class="btn-save" id="feedback-save"> ì €ì¥ </button> </div> </div> </div> `}initEventListeners(){this.positiveTextarea = document.getElementById('feedback-positive');this.negativeTextarea = document.getElementById('feedback-negative');this.suggestionTextarea = document.getElementById('feedback-suggestion');this.positiveCount = document.querySelector('#positive-count .count-current');this.negativeCount = document.querySelector('#negative-count .count-current');this.suggestionCount = document.querySelector('#suggestion-count .count-current');this.statusText = document.getElementById('feedback-status-text');this.positiveTextarea.addEventListener('input', () =>{this.handleInput('positive', this.positiveTextarea, this.positiveCount)});this.negativeTextarea.addEventListener('input', () =>{this.handleInput('negative', this.negativeTextarea, this.negativeCount)});this.suggestionTextarea.addEventListener('input', () =>{this.handleInput('suggestion', this.suggestionTextarea, this.suggestionCount)});const saveBtn = document.getElementById('feedback-save');if (saveBtn){saveBtn.addEventListener('click', () => this.save())}const clearBtn = document.getElementById('feedback-clear');if (clearBtn){clearBtn.addEventListener('click', () => this.clear())}}handleInput(field, textarea, counter){const value = textarea.value;const length = value.length;this.feedback[field] = value;counter.textContent = length;if (length >= this.maxLength * 0.9){counter.parentElement.classList.add('count-warning')}else{counter.parentElement.classList.remove('count-warning')}if (this.onChange){this.onChange(this.feedback)}if (this.autoSave){this.scheduleAutoSave()}this.updateStatus('ë³€ê²½ë¨')}scheduleAutoSave(){if (this.autoSaveTimer){clearTimeout(this.autoSaveTimer)}this.autoSaveTimer = setTimeout(() =>{this.save(true)}, this.autoSaveDelay)}async save(isAutoSave = false){try{const validation = this.validate();if (!validation.valid){this.showError(validation.message);return}if (this.onSave){this.updateStatus(isAutoSave ? 'ìë™ ì €ì¥ ì¤‘...' : 'ì €ì¥ ì¤‘...');await this.onSave(this.feedback);this.lastSaved = new Date();this.updateStatus(isAutoSave ? `ìë™ ì €ì¥ë¨ (${this.formatTime(this.lastSaved)})` : 'ì €ì¥ ì™„ë£Œ!')}}catch (error){console.error('âŒ í”¼ë“œë°± ì €ì¥ ì‹¤íŒ¨:', error);this.showError('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message)}}validate(){const isEmpty = !this.feedback.positive && !this.feedback.negative && !this.feedback.suggestion;if (isEmpty){return{valid: false, message: 'ìµœì†Œ í•˜ë‚˜ì˜ í”¼ë“œë°±ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'}}for (const [field, value] of Object.entries(this.feedback)){if (value.length > this.maxLength){return{valid: false, message: `${this.getFieldName(field)}ì´(ê°€) ìµœëŒ€ ê¸¸ì´ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.`}}}return{valid: true, message: ''}}getFieldName(field){const names ={positive: 'ì¢‹ì•˜ë˜ ì ', negative: 'ì•„ì‰¬ìš´ ì ', suggestion: 'ê°œì„  ì œì•ˆ'};return names[field] || field}clear(){if (!confirm('ì‘ì„±í•œ ë‚´ìš©ì„ ëª¨ë‘ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')){return}this.positiveTextarea.value = '';this.negativeTextarea.value = '';this.suggestionTextarea.value = '';this.feedback ={positive: '', negative: '', suggestion: ''};this.positiveCount.textContent = '0';this.negativeCount.textContent = '0';this.suggestionCount.textContent = '0';this.updateStatus('ì´ˆê¸°í™”ë¨')}setFeedback(feedback){if (feedback.positive !== undefined){this.positiveTextarea.value = feedback.positive;this.feedback.positive = feedback.positive;this.positiveCount.textContent = feedback.positive.length}if (feedback.negative !== undefined){this.negativeTextarea.value = feedback.negative;this.feedback.negative = feedback.negative;this.negativeCount.textContent = feedback.negative.length}if (feedback.suggestion !== undefined){this.suggestionTextarea.value = feedback.suggestion;this.feedback.suggestion = feedback.suggestion;this.suggestionCount.textContent = feedback.suggestion.length}}getFeedback(){return{...this.feedback}}updateStatus(message){if (this.statusText){this.statusText.textContent = message;this.statusText.className = 'status-text status-info'}}showError(message){if (this.statusText){this.statusText.textContent = message;this.statusText.className = 'status-text status-error'}setTimeout(() =>{this.updateStatus('')}, 3000)}formatTime(date){return date.toLocaleTimeString('ko-KR',{hour: '2-digit', minute: '2-digit'})}addStyles(){if (document.getElementById('feedback-form-styles')){return}const style = document.createElement('style');style.id = 'feedback-form-styles';style.textContent = ` .feedback-form{background: white;border-radius: 12px;padding: 24px;box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1)}.feedback-form-header{margin-bottom: 24px}.feedback-form-header h3{font-size: 20px;font-weight: 700;color: #2c3e50;margin-bottom: 8px}.feedback-form-description{font-size: 14px;color: #7f8c8d}.feedback-form-body{display: flex;flex-direction: column;gap: 24px}.feedback-field{display: flex;flex-direction: column;gap: 8px}.feedback-label{display: flex;align-items: center;gap: 8px;font-weight: 600;color: #2c3e50;font-size: 15px}.label-icon{font-size: 20px}.label-optional{font-size: 12px;color: #95a5a6;font-weight: 400}.feedback-textarea{width: 100%;padding: 12px;border: 2px solid #e1e8ed;border-radius: 8px;font-family: inherit;font-size: 14px;line-height: 1.6;resize: vertical;transition: border-color 0.3s ease}.feedback-textarea:focus{outline: none;border-color: #667eea;box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1)}.feedback-textarea::placeholder{color: #bdc3c7}.feedback-meta{display: flex;justify-content: space-between;align-items: center;gap: 12px}.feedback-help{font-size: 12px;color: #95a5a6;flex: 1}.feedback-count{font-size: 13px;color: #7f8c8d;font-weight: 600;white-space: nowrap}.count-warning{color: #e74c3c}.feedback-form-footer{display: flex;justify-content: space-between;align-items: center;margin-top: 24px;padding-top: 24px;border-top: 2px solid #ecf0f1}.feedback-status{flex: 1}.status-text{font-size: 14px;font-weight: 600}.status-info{color: #3498db}.status-error{color: #e74c3c}.feedback-actions{display: flex;gap: 12px}.btn-clear, .btn-save{padding: 10px 20px;border: none;border-radius: 8px;font-size: 14px;font-weight: 600;cursor: pointer;transition: all 0.3s ease}.btn-clear{background: #ecf0f1;color: #2c3e50}.btn-clear:hover{background: #d1d8dd}.btn-save{background: #667eea;color: white}.btn-save:hover{background: #5568d3}.btn-clear:focus, .btn-save:focus{outline: none;box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3)}@media (max-width: 768px){.feedback-form{padding: 16px}.feedback-meta{flex-direction: column;align-items: flex-start}.feedback-form-footer{flex-direction: column;gap: 16px;align-items: stretch}.feedback-actions{width: 100%}.btn-clear, .btn-save{flex: 1}}@media (prefers-color-scheme: dark){.feedback-form{background: #2c2c2c}.feedback-form-header h3, .feedback-label{color: #e1e8ed}.feedback-textarea{background: #1a1a1a;border-color: #3a3a3a;color: #e1e8ed}.feedback-textarea:focus{border-color: #667eea}.btn-clear{background: #3a3a3a;color: #e1e8ed}}`;document.head.appendChild(style)}cleanup(){if (this.autoSaveTimer){clearTimeout(this.autoSaveTimer)}this.container.innerHTML = ''}}if (typeof module !== 'undefined' && module.exports){module.exports = FeedbackFormUI}