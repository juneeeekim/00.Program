class RatingStatisticsUI{constructor(analyticsManager, container){if (!analyticsManager || !container){throw new Error('AnalyticsManagerì™€ containerê°€ í•„ìš”í•©ë‹ˆë‹¤.')}this.analyticsManager = analyticsManager;this.container = container;this.statistics = null;this.init()}init(){this.addStyles()}async load(promptId){try{this.showLoading();this.statistics = await this.analyticsManager.calculateRatingStatistics(promptId);this.render()}catch (error){console.error('âŒ í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);this.showError(error.message)}}render(){if (!this.statistics){this.showEmpty();return}this.container.innerHTML = ` <div class="rating-statistics"> <!-- ìš”ì•½ ì¹´ë“œ --> <div class="stats-summary"> ${this.renderSummaryCard()}</div> <!-- í‰ì  ë¶„í¬ ì°¨íŠ¸ --> <div class="stats-distribution"> <h3>í‰ì  ë¶„í¬</h3> ${this.renderDistributionChart()}</div> <!-- ìƒì„¸ í†µê³„ --> <div class="stats-details"> ${this.renderDetailCards()}</div> </div> `}renderSummaryCard(){const{averageRating, totalExecutions, totalRatings, successRate}= this.statistics;return ` <div class="summary-card"> <div class="summary-item summary-main"> <div class="summary-icon">â­</div> <div class="summary-content"> <div class="summary-value">${averageRating.toFixed(1)}</div> <div class="summary-label">í‰ê·  í‰ì </div> <div class="summary-stars">${this.renderStars(averageRating)}</div> </div> </div> <div class="summary-item"> <div class="summary-icon">ğŸ“Š</div> <div class="summary-content"> <div class="summary-value">${totalExecutions}</div> <div class="summary-label">ì´ ì‹¤í–‰ íšŸìˆ˜</div> </div> </div> <div class="summary-item"> <div class="summary-icon">ğŸ’¯</div> <div class="summary-content"> <div class="summary-value">${successRate.toFixed(1)}%</div> <div class="summary-label">ì„±ê³µë¥  (4ì  ì´ìƒ)</div> </div> </div> <div class="summary-item"> <div class="summary-icon">ğŸ“</div> <div class="summary-content"> <div class="summary-value">${totalRatings}</div> <div class="summary-label">í‰ê°€ ìˆ˜</div> </div> </div> </div> `}renderStars(rating){const fullStars = Math.floor(rating);const hasHalfStar = rating % 1 >= 0.5;const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);let html = '';for (let starIndex = 0;starIndex < fullStars;starIndex++){html += '<span class="star star-full">â˜…</span>'}if (hasHalfStar){html += '<span class="star star-half">â˜…</span>'}for (let starIndex = 0;starIndex < emptyStars;starIndex++){html += '<span class="star star-empty">â˜…</span>'}return html}renderDistributionChart(){const{ratingDistribution, totalRatings}= this.statistics;let html = '<div class="distribution-chart">';for (let rating = 5;rating >= 1;rating--){const count = ratingDistribution[rating] || 0;const percentage = totalRatings > 0 ? (count / totalRatings) * 100 : 0;html += ` <div class="distribution-row"> <div class="distribution-label"> <span class="rating-number">${rating}</span> <span class="rating-star">â˜…</span> </div> <div class="distribution-bar-container"> <div class="distribution-bar" style="width: ${percentage}%"> <div class="distribution-bar-fill rating-${rating}"></div> </div> </div> <div class="distribution-count"> <span class="count-number">${count}</span> <span class="count-percentage">(${percentage.toFixed(1)}%)</span> </div> </div> `}html += '</div>';return html}renderDetailCards(){const{medianRating, modeRating, standardDeviation, highRatingRate}= this.statistics;return ` <div class="detail-cards"> <div class="detail-card"> <div class="detail-icon">ğŸ“ˆ</div> <div class="detail-label">ì¤‘ì•™ê°’</div> <div class="detail-value">${medianRating.toFixed(1)}</div> </div> <div class="detail-card"> <div class="detail-icon">ğŸ¯</div> <div class="detail-label">ìµœë¹ˆê°’</div> <div class="detail-value">${modeRating.toFixed(1)}</div> </div> <div class="detail-card"> <div class="detail-icon">ğŸ“Š</div> <div class="detail-label">í‘œì¤€í¸ì°¨</div> <div class="detail-value">${standardDeviation.toFixed(2)}</div> </div> <div class="detail-card"> <div class="detail-icon">ğŸŒŸ</div> <div class="detail-label">5ì  ë¹„ìœ¨</div> <div class="detail-value">${highRatingRate.toFixed(1)}%</div> </div> </div> `}showLoading(){this.container.innerHTML = ` <div class="stats-loading"> <div class="spinner"></div> <p>í†µê³„ë¥¼ ê³„ì‚°í•˜ëŠ” ì¤‘...</p> </div> `}showEmpty(){this.container.innerHTML = ` <div class="stats-empty"> <div class="empty-icon">ğŸ“Š</div> <h3>í†µê³„ê°€ ì—†ìŠµë‹ˆë‹¤</h3> <p>í”„ë¡¬í”„íŠ¸ë¥¼ ì‹¤í–‰í•˜ê³  í‰ê°€í•˜ë©´ í†µê³„ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p> </div> `}showError(message){this.container.innerHTML = ` <div class="stats-error"> <div class="error-icon">âš ï¸</div> <h3>í†µê³„ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h3> <p>${message}</p> </div> `}addStyles(){if (document.getElementById('rating-statistics-styles')){return}const style = document.createElement('style');style.id = 'rating-statistics-styles';style.textContent = ` .rating-statistics{display: flex;flex-direction: column;gap: 24px}.stats-summary{background: white;border-radius: 12px;padding: 24px;box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1)}.summary-card{display: grid;grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));gap: 20px}.summary-item{display: flex;align-items: center;gap: 16px;padding: 16px;background: #f8f9fa;border-radius: 8px}.summary-main{grid-column: span 2;background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);color: white}.summary-icon{font-size: 32px}.summary-content{flex: 1}.summary-value{font-size: 32px;font-weight: 700;line-height: 1;margin-bottom: 8px}.summary-label{font-size: 14px;opacity: 0.8}.summary-stars{margin-top: 8px;font-size: 20px}.star{margin-right: 2px}.star-full{color: #FFD700}.star-half{color: #FFD700;opacity: 0.5}.star-empty{color: #ddd}.stats-distribution{background: white;border-radius: 12px;padding: 24px;box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1)}.stats-distribution h3{font-size: 18px;font-weight: 600;color: #2c3e50;margin-bottom: 20px}.distribution-chart{display: flex;flex-direction: column;gap: 12px}.distribution-row{display: grid;grid-template-columns: 60px 1fr 120px;gap: 12px;align-items: center}.distribution-label{display: flex;align-items: center;gap: 4px;font-weight: 600;color: #2c3e50}.rating-number{font-size: 18px}.rating-star{color: #FFD700;font-size: 16px}.distribution-bar-container{height: 32px;background: #f0f0f0;border-radius: 16px;overflow: hidden}.distribution-bar{height: 100%;transition: width 0.5s ease}.distribution-bar-fill{height: 100%;border-radius: 16px}.rating-5{background: #27ae60}.rating-4{background: #2ecc71}.rating-3{background: #f39c12}.rating-2{background: #e67e22}.rating-1{background: #e74c3c}.distribution-count{display: flex;align-items: center;gap: 8px;font-size: 14px}.count-number{font-weight: 700;color: #2c3e50}.count-percentage{color: #7f8c8d}.stats-details{background: white;border-radius: 12px;padding: 24px;box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1)}.detail-cards{display: grid;grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));gap: 16px}.detail-card{text-align: center;padding: 20px;background: #f8f9fa;border-radius: 8px}.detail-icon{font-size: 32px;margin-bottom: 12px}.detail-label{font-size: 14px;color: #7f8c8d;margin-bottom: 8px}.detail-value{font-size: 24px;font-weight: 700;color: #2c3e50}.stats-loading{text-align: center;padding: 60px 20px}.spinner{width: 50px;height: 50px;margin: 0 auto 20px;border: 5px solid #e1e8ed;border-top-color: #667eea;border-radius: 50%;animation: spin 1s linear infinite}@keyframes spin{to{transform: rotate(360deg)}}.stats-empty{text-align: center;padding: 60px 20px}.empty-icon{font-size: 64px;margin-bottom: 20px}.stats-empty h3{font-size: 20px;font-weight: 600;color: #2c3e50;margin-bottom: 10px}.stats-empty p{font-size: 14px;color: #7f8c8d}.stats-error{text-align: center;padding: 60px 20px}.error-icon{font-size: 64px;margin-bottom: 20px}.stats-error h3{font-size: 20px;font-weight: 600;color: #e74c3c;margin-bottom: 10px}.stats-error p{font-size: 14px;color: #7f8c8d}@media (max-width: 768px){.summary-main{grid-column: span 1}.summary-card{grid-template-columns: 1fr}.distribution-row{grid-template-columns: 50px 1fr 100px;gap: 8px}.detail-cards{grid-template-columns: repeat(2, 1fr)}}`;document.head.appendChild(style)}cleanup(){this.container.innerHTML = '';this.statistics = null}}if (typeof module !== 'undefined' && module.exports){module.exports = RatingStatisticsUI}